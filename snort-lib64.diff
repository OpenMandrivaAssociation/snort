--- snort-2.9.2.1/configure.in	2012-01-06 09:27:28.000000000 -0600
+++ snort-2.9.2.1.dlucio/configure.in	2012-01-28 18:41:05.181659817 -0600
@@ -78,7 +78,20 @@
     linux="yes"
     AC_DEFINE([LINUX],[1],[Define if Linux])
     AC_SUBST(extra_incl)
-    extra_incl="-I/usr/include/pcap"
+   extra_incl="-I/usr/include/pcap"
+    # Test if the compiler is 64bit
+    echo 'int i;' > conftest.$ac_ext
+    snort_cv_cc_64bit_output=no
+    if AC_TRY_EVAL(ac_compile); then
+      case `/usr/bin/file conftest.$ac_objext` in
+      *"ELF 64"*)
+       snort_cv_cc_64bit_output=yes
+        ;;
+      esac
+    fi
+    rm -rf conftest*
+
+
     ;;
   *-hpux10*|*-hpux11*)
     AC_DEFINE([HPUX],[1],[Define if HP-UX 10 or 11])
@@ -115,6 +128,15 @@
     extra_incl="-I/sw/include"
 esac
 
+case $host_cpu:$snort_cv_cc_64bit_output in
+powerpc64:yes | s390x:yes | sparc64:yes | x86_64:yes)
+  snort_libname="lib64"
+  ;;
+*:*)
+  snort_libname="lib"
+  ;;
+esac
+
 AC_HEADER_STDBOOL
 
 # ICC stuff
